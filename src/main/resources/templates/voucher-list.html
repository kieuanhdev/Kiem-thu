<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Quản lý Voucher</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

<div class="d-flex">
    <div th:replace="~{fragments/sidebar :: sidebar('vouchers')}"></div>

    <div class="flex-grow-1 p-4 bg-light vh-100 overflow-auto">

        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="text-warning text-dark fw-bold">DANH SÁCH MÃ GIẢM GIÁ</h2>
            <a href="/admin/vouchers/create" class="btn btn-primary">
                <i class="fas fa-plus-circle me-1"></i> Tạo Voucher Mới
            </a>
        </div>

        <div class="card shadow-sm">
            <div class="card-body">
                <table class="table table-hover align-middle">
                    <thead class="table-warning">
                    <tr>
                        <th>Mã Code</th>
                        <th>Tên chương trình</th>
                        <th>Loại giảm</th>
                        <th>Giá trị</th>
                        <th>Đơn tối thiểu</th>
                        <th>Hạn sử dụng</th>
                        <th>Lượt dùng</th>
                        <th>Trạng thái</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="v : ${vouchers}">
                        <td><span class="badge bg-dark" th:text="${v.code}">SALE10</span></td>
                        <td th:text="${v.name}">Khuyến mãi hè</td>
                        <td th:text="${v.discountType}">PERCENTAGE</td>
                        <td th:text="${#numbers.formatDecimal(v.discountValue, 0, 'COMMA', 0, 'POINT')}">10</td>
                        <td th:text="${#numbers.formatDecimal(v.minOrderValue, 0, 'COMMA', 0, 'POINT')} + ' đ'">100.000</td>
                        <td>
                            <small th:text="${#temporals.format(v.startAt, 'dd/MM/yyyy')} + ' - ' + ${#temporals.format(v.endAt, 'dd/MM/yyyy')}"></small>
                        </td>
                        <td>
                            <span th:text="${v.usedCount} + '/' + ${v.usageLimit}">0/100</span>
                            <div class="progress mt-1" style="height: 3px;">
                                <div class="progress-bar bg-success"
                                     th:style="'width:' + (${v.usageLimit} > 0 ? (${v.usedCount} * 100 / ${v.usageLimit}) : 0) + '%'"></div>
                            </div>
                        </td>
                        <td>
                            <span th:if="${v.active}" class="badge bg-success">Active</span>
                            <span th:unless="${v.active}" class="badge bg-danger">Locked</span>
                        </td>
                    </tr>
                    <tr th:if="${vouchers.empty}">
                        <td colspan="8" class="text-center text-muted py-4">Chưa có mã giảm giá nào.</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>